<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>JS Stopwatch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Raleway|Spectral" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../main.css">
    <link rel="stylesheet" type="text/css" href="../responsive.css">
    <meta name="Javascript stopwatch by TKG" content="A stopwatch that records splits and calculates paces">
    <link rel="shortcut icon" href="../images/home-icon-4.png" type="image/x-icon">
</head>

<body>
    <!--HEADER-->
    <div id="main_menu"></div>
    <header class="navbar-fixed-top">
        <a class="navbar-brand" href="index.html">
            <img src="../images/home-icon.png" alt="My home icon.">
        </a>
        <div class="overflow-protection">
            <ul class="navbar-right">
                <li>
                    <a href="../about.html">about</a>
                </li>
                <li>
                    <a href="../wood.html">wood</a>
                </li>
                <li>
                    <a href="../writing.html">writing</a>
                </li>
                <li class="current">
                    <!--LEFT BORDER ON CURRENT PAGE-->
                    <a href="../code.html">code</a>
                </li>
                <li>
                    <a href="../running.html">running</a>
                </li>
            </ul>
        </div>
    </header>
    <!--END HEADER-->

    <div class="main-content application">
        <div class="digital">
            <div class="digital-display">
                <p class="digital-hours">
                    0h
                </p>
                <p class="digital-minutes">
                    00m
                </p>
                <p class="digital-seconds">
                    00s
                </p>
                <p class="digital-ms">
                    00
                </p>
            </div>
        </div>
        <div class="buttons">
            <button id="start">Start</button>
            <button id="stop">Stop</button>
            <button id="split">Split</button>
            <button id="reset">Reset</button>
            <button id="pace">Hide Pace</button>
        </div>

        <div>
            <h2 style="font-weight: 900;">Splits:</h2>
            <ul class="splits"></ul>
        </div>
    </div>

    <div id="footer">
        <div id="center" class="column placeholder-box col-xl-3"></div>
        <div id="center" class="column col-xl-3 col-l-4 col-m-4 col-s-7">
            <h3>interesting</h3>
            <p>Congratulations! You've found the personal website of Thomas Graham. I'm originally from Raleigh, North
                Carolina and now make home in San Francisco.
                For more information about me and about this site, please see my <a href="../about.html">about</a>
                page.
            </p>
        </div>
        <div id="center" class="column col-xl-3 col-l-4 col-m-4 col-s-7">
            <h3>available</h3>
            <div class="social-list">
                <a id="facebook" href="https://www.facebook.com/thomas.graham.756/" alt="Thomas Graham's Facebook Page"
                    title="Thomas's Facebook Page">
                    <img src="../images/f-Logo_Assets/F_Logo_Online_09_2018/White/SVG/flogo-HexRBG-Wht-512.svg">
                </a>
                <a id="instagram" href="https://www.instagram.com/picsbytgraham/" title="He once had an Instagram, too...">
                    <img class="col-12" src="../images/GlyphLogo_May2016_Onlinev2/Insta_purple.png">
                </a>
                <a id="twitter" href="https://twitter.com/tgthepastaman" alt="Thomas Graham's Twitter Account." title="Thomas Graham's Antiquated Twitter">
                    <img class="col-12" src="../images/Twitter Logos/Twitter Logos/Twitter_Logo_Blue/Twitter-Logo-Purple.png">
                </a>
                <a id="linkedin" href="https://www.linkedin.com/in/thomas-graham-b23934130/" alt="Thomas Graham's LinkedIn Page"
                    title="My LinkedIn Page">
                    <img class="col-12" src="../images/linkedin_brand_package/Linkedin.png">
                </a>
            </div>
            <br>
            <ul>
                <li>Find me in SF's beautiful <a href="https://goo.gl/maps/qqmFcuEKcDT2">Lower Haight</a></li>
                <li>Or at <a href="http://beanbag.cafe/">various</a> <a href="http://www.neighborscornersf.com/">internet</a>
                    <a href="http://www.streamlinesf.com/">cafes</a></li>
                <li>The literarily inclined can <a href="mailto:graham.thomask@gmail.com?Subject=I%20hate%20your%20website">email
                        me</a></li>
                <li>(Don't call me - it's 2018)</li>
            </ul>
        </div>
        <div id="center" class="column col-xl-3 col-l-4 col-m-4 col-s-7">
            <h3>honest</h3>
            <p id="bottom-footer-p">
                This website was made by me (Thomas). I did so by taking some <a href="mozilla website" alt="Mozilla's learning website.">
                    online courses</a> through
                Mozilla Firefox's delightful developer site.
                I also looked through some templates from <a href="bootstrap templates" alt="
                                    bootstrap templates website">Bootstrap
                    Templates.</a> The code relies on some of their design concepts, but was all written from scratch
                by me (<em>i.e.</em> not from a template).
            </p>
        </div>
    </div>
    <div class="small-footer">
        <div class="column placeholder-box col-xl-3"></div>
        <p class="column col-xl-9">Â© 2018, TKG Enterprises, LLC. All rights reserved. Not liable for anything. |
            <a href="https://app.termly.io/document/privacy-policy/e9612db4-7e59-4bdb-a0be-d9635f33f77b">Privacy Policy</a>
            |
            <a href="disclaimer.html">Scary Legal Disclaimer</a>
            |
            <a href="https://www.bojangles.com/">Delicious Biscuits</a>

        </p>
    </div>
    <div class="to-top">
        <a href="#main_menu"><img src="../images/to-top-black.png"></a>

    </div>
    <!--FIN DE FOOTER-->

    <style>
        .application {
            font-size: 1.4rem;
            flex: 1;
            min-height: 100vh;
            align-items: center;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            background-color: #018DED;
            padding-bottom: 15px;
        }

        .buttons button {
            margin: 20px auto;
            background-color: purple;
            font-family: 'Raleway', sans-serif;
            font-size: 1.4rem;
            color: white;
            /* border-radius: 50%; */
            border: 5px black solid;
            width: 80px;
            height: 80px;
            text-align: center;
            padding: 0;
        }

        .buttons {
            display: flex;
            justify-content: flex-start;
            flex-wrap: wrap;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .digital {
            box-sizing: border-box;
            width: 100%;
            max-width: 600px;
            height: 12rem;
            margin-top: 10%;
            margin-left: auto;
            margin-right: auto;
            border: 10px solid white;
            border-radius: 5%;
            /* margin: 50px auto; */
            box-shadow:
                0 0 0 4px rgba(0, 0, 0, 0.1),
                inset 0 0 0 3px #EFEFEF,
                inset 0 0 10px black,
                0 0 10px rgba(0, 0, 0, 0.2);
            color: white;
            font-size: calc(160% + 3vw);;

        }

        .digital-display {
            display: flex;
            align-items: center;
            justify-content: start;
            width: 100%;
            height: 100%;
            font-family: 'Raleway', sans-serif;
            font-weight: 900;
            padding: 5px 12px 12px 10px;
            box-sizing: border-box;
        }

        .digital-hours,
        .digital-minutes {
            text-align: center;
        }

        .digital-seconds {
            width: 30%;
            color: lightgray;
        }

        .digital-ms {
            width: 8%;
            font-size: 60%;
        }

        .digital-hours {
            width: 23%;
            color: orange;
        }

        .digital-minutes {
            width: 34%;
            color: greenyellow;
        }

        .splits {
            list-style: none;
            font-family: 'Raleway', sans-serif;
        }

        .splits li {
            margin-bottom: 10px;
        }

        .splits li p {
            display: inline-block;
            margin: 5px 10px;
        }

        #reset,
        #split,
        #stop,
        #pace {
            display: none;
        }

        .pace-distance,
        .pace-button {
            font-family: 'Raleway', sans-serif;
            font-size: 1rem;
            margin: 5px 10px;
            text-align: center;
        }

        .pace-button {
            margin: 0;
            margin-right: 10px;
            border: 2px solid black;
            border-radius: 3px;
            background-color: black;
            color: white;
        }
    </style>


    <script>

        const digitalSeconds = document.querySelector('.digital-seconds');
        const digitalMinutes = document.querySelector('.digital-minutes');
        const digitalHours = document.querySelector('.digital-hours');
        const digitalMs = document.querySelector('.digital-ms');

        let ms = 0;
        let seconds = 0;
        let minutes = 0;
        let hours = 0;

        let clearTime;

        //so that seconds always display 2 digits; e.g. '09' instead of '9'
        function minTwoDigits(n) {
            return (n < 10 ? '0' : '') + n;
        }

        function excludeIfZero(n) {
            return (n === 0 ? '' : n);
        }

        function updateStopwatch() {
            if (ms === 100) {
                seconds++;
                ms = 0;
            }
            digitalMs.innerHTML = (ms < 10) ? ('0' + ms) : ms;
            if (seconds === 60) {
                minutes++;
                seconds = 0;
            }
            digitalSeconds.innerHTML = (seconds < 10) ? ('0' + seconds + 's') : (seconds + 's');
            if (minutes === 60) {
                hours++;
                minutes = 0;
            }
            digitalMinutes.innerHTML = (minutes < 10) ? ('0' + minutes + 'm') : (minutes + 'm');
            digitalHours.innerHTML = (hours + 'h');
            ms++;
            clearTime = setTimeout('updateStopwatch()', 10);
        }

        // Allows for buttons to be displayed or hidden as appropriate
        var splitDisplay = document.getElementById('split');
        var resetDisplay = document.getElementById('reset');
        var stopDisplay = document.getElementById('stop');
        var startDisplay = document.getElementById('start');
        var paceDisplay = document.getElementById('pace');

        function startTime() {
            //if (ms === 0 && seconds === 0 && minutes === 0 && hours === 0) {
            this.style.display = 'none';
            stopDisplay.style.display = 'inline-block';
            splitDisplay.style.display = 'inline-block';
            resetDisplay.style.display = 'none';

            updateStopwatch();
        }

        function stopTime() {
            if (ms !== 0 || seconds !== 0 || minutes !== 0 || hours !== 0) {

                startDisplay.style.display = 'inline-block';
                // showStart.addEventListener('click', startTime);
                resetDisplay.style.display = 'inline-block';
                this.style.display = 'none';
                clearTimeout(clearTime);
            }
        }

        var lastSplit = '';

        /* trying to get stopwatch to freeze on a split for 3s whenever taken.
        function displayLastSplit() {
            const tempMs = ms;
            const tempSec = seconds;
            const tempMin = minutes;
            const tempHr = hours;
            digitalMs.innerHTML = (tempMs < 10) ? ('0' + tempMs) : tempMs;
            digitalSeconds.innerHTML = (tempSec < 10) ? ('0' + tempSec + 's') : (tempSec + 's');
            digitalMinutes.innerHTML = (tempMin < 10) ? ('0' + tempMin + 'm') : (tempMin + 'm');
            digitalHours.innerHTML = (TempHr + 'h');
            clearTimeout(clearTime);
        } */

        var lastHour = 0;
        var lastMinute = 0;
        var lastSecond = 0;
        var lastMs = 0;

        //var thisHour, thisMinute, thisSecond, thisMs = 0;

        var lastTotalTime = 0;


        function takeSplit() {
            //show pace display button;
            paceDisplay.style.display = 'inline-block';

            var splitInstance = document.createElement('li');
            splitInstance.setAttribute('class', 'split-li');

            var splitDistance = document.createElement('input');
            splitDistance.setAttribute('class', 'pace-distance');
            if (paceDisplay.innerHTML === 'Show Pace') {
                splitDistance.style.display = 'none';
            }

            var splitCalcButton = document.createElement('button');
            splitCalcButton.setAttribute('class', 'pace-button');
            if (paceDisplay.innerHTML === 'Show Pace') {
                splitCalcButton.style.display = 'none';
            }

            splitDistance.setAttribute('type', 'text');
            splitDistance.setAttribute('placeholder', 'Split distance (mi)');
            splitCalcButton.innerHTML = 'Calculate split pace';

            //captures the time at the instant the split is taken to avoid incorrect split/pace calculation later on; records in ms
            var totalTime = (hours * 360000) + (minutes * 6000) + (seconds * 100) + ms;
            console.log('total is ' + totalTime);

            var splitTime = totalTime - lastTotalTime;
            var splitTimeCopy = splitTime;
            console.log('split time is ' + splitTime);
            lastTotalTime = totalTime;
            console.log('last total time is ' + lastTotalTime);

            var thisHour = Math.floor(splitTime / 360000);
            splitTime -= (thisHour * 360000);
            console.log('this hour is ' + thisHour);

            var thisMinute = Math.floor(splitTime / 6000);
            splitTime -= (thisMinute * 6000);
            console.log('this minute is ' + thisMinute);

            var thisSecond = Math.floor(splitTime / 100);
            splitTime -= (thisSecond * 100);
            console.log('this second is ' + thisSecond);

            var thisMs = splitTime;
            console.log('this ms is ' + thisMs);

            //counts the number of children in the split list to assign numbers to each split. 
            var splitCount = document.querySelector('.splits').childElementCount;

            splitInstance.textContent = minTwoDigits(thisHour) + ':' + minTwoDigits(thisMinute) + ':' + minTwoDigits(thisSecond) + '.' + minTwoDigits(thisMs);

            //keeps from recording the same split multiple times, and from recording a split of 0
            if (lastSplit !== splitInstance.textContent && splitTimeCopy !== 0) {
                var splitList = document.querySelector('.splits');
                splitCount++;
                lastSplit = splitInstance.textContent;

                //if the timer hasn't been running an hour, only shows minutes/seconds/ms
                if (hours === 0) {
                    splitInstance.textContent = 'Lap ' + splitCount + ': ' + minTwoDigits(thisMinute) + ':' + minTwoDigits(thisSecond) + '.' + minTwoDigits(thisMs);
                } else {
                    splitInstance.textContent = 'Lap ' + splitCount + ': ' + minTwoDigits(thisHour) + ':' + minTwoDigits(thisMinute) + ':' + minTwoDigits(thisSecond) + '.' + minTwoDigits(thisMs);;
                }

                //adds the split information to the page
                splitList.appendChild(splitInstance);
                splitInstance.appendChild(splitDistance);
                splitInstance.appendChild(splitCalcButton);

                function calculatePace() {

                    if (!isNaN(splitDistance.value) && splitDistance.value !== '') {
                        splitTimeCopy = splitTimeCopy / splitDistance.value;

                        var splitPace = document.createElement('p');
                        splitPace.setAttribute('class', 'pace-calculation');

                        var paceHours = Math.floor(splitTimeCopy / 360000);
                        splitTimeCopy = splitTimeCopy - (paceHours * 360000);


                        var paceMinutes = Math.floor(splitTimeCopy / 6000);
                        splitTimeCopy = splitTimeCopy - (paceMinutes * 6000);


                        var paceSeconds = Math.floor(splitTimeCopy / 100);
                        splitTimeCopy = splitTimeCopy - (paceSeconds * 100);

                        var paceMs = splitTimeCopy.toFixed();

                        if (hours === 0) {
                            splitPace.textContent = 'Pace: ' + minTwoDigits(paceMinutes) + ':' + minTwoDigits(paceSeconds) + '.' + minTwoDigits(paceMs) + ' per Mile';

                            //tests if there is already a <p> element listing the split; gives the ability to recalculate based on new split distance information
                            if (splitInstance.childElementCount === 3) {
                                splitInstance.removeChild(splitInstance.lastChild);
                            }
                            splitInstance.appendChild(splitPace);
                        } else {
                            splitPace.textContent = 'Pace: ' + minTwoDigits(paceHours) + ':' + minTwoDigits(paceMinutes) + ':' + minTwoDigits(paceSeconds) + '.' + minTwoDigits(paceMs) + ' per Mile';
                            if (splitInstance.childElementCount === 3) {
                                splitInstance.removeChild(splitInstance.lastChild);
                            }
                            splitinstance.appendChild(splitPace);
                        }
                        //splitCalcButton.removeEventListener('click', calculatePace);
                    }
                }

                splitCalcButton.addEventListener('click', calculatePace);


            }
        }

        function resetWatch() {
            digitalMs.innerHTML = '00';
            digitalSeconds.innerHTML = '00s';
            digitalMinutes.innerHTML = '00m';
            digitalHours.innerHTML = '0h';

            ms = 0;
            seconds = 0;
            minutes = 0;
            hours = 0;

            lastTotalTime = 0;

            splitDisplay.style.display = 'none';
            this.style.display = 'none';
            stopDisplay.style.display = 'none';
            startDisplay.style.display = 'inline-block';
            paceDisplay.style.display = 'none';

            //loop through list, delete all listed splits
            var times = document.querySelectorAll('.split-li');
            for (i = 0; i < times.length; i++) {
                times[0].parentNode.removeChild(times[0].parentNode.lastChild);
            }
        }

        function togglePaceDisplay() {
            var paceButtons = document.querySelectorAll('.pace-button');
            var paceDistances = document.querySelectorAll('.pace-distance');
            var paceCalculations = document.querySelectorAll('.pace-calculation');
            console.log('fuck');
            console.log(paceDisplay.innerHTML);
            if (paceDisplay.innerHTML === 'Hide Pace') {
                for (i = 0; i < paceButtons.length; i++) {
                    paceButtons[i].style.display = 'none';
                    paceDistances[i].style.display = 'none';
                    if (paceCalculations[i]) {
                        paceCalculations[i].style.display = 'none';
                    }
                    this.innerHTML = 'Show Pace';
                }
            } else {
                for (i = 0; i < paceButtons.length; i++) {
                    paceButtons[i].style.display = 'inline-block';
                    paceDistances[i].style.display = 'inline-block';
                    if (paceCalculations[i]) {
                        paceCalculations[i].style.display = 'inline-block';
                    }
                    this.innerHTML = 'Hide Pace';
                }
            }
        }


        // Event Listeners for button functionality
        window.addEventListener('load', function () {
            var start = document.getElementById('start');
            start.addEventListener('click', startTime);
        });

        window.addEventListener('load', function () {
            var pace = document.getElementById('pace');
            pace.addEventListener('click', togglePaceDisplay);
        });

        window.addEventListener('load', function () {
            var stop = document.getElementById('stop');
            stop.addEventListener('click', stopTime);
        });

        window.addEventListener('load', function () {
            var split = document.getElementById('split');
            split.addEventListener('click', takeSplit);
        });

        window.addEventListener('load', function () {
            var reset = document.getElementById('reset');
            reset.addEventListener('click', resetWatch);
        });

        stopTime();


    </script>
</body>



</html>